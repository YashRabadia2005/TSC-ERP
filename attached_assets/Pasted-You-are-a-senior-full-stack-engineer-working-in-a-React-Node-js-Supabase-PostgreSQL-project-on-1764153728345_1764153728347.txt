You are a senior full-stack engineer working in a React + Node.js + Supabase (PostgreSQL) project on Replit.
This project is an ERP for a Sugar Manufacturing Unit.
I want you to design and develop a complete CRM module where all buttons and actions are fully working, not dummy.
Tech stack:
Frontend: React
Backend: Node.js / Express (or existing API pattern in this repo)
Database: Supabase (PostgreSQL)
ğŸ¯ BUSINESS CONTEXT â€“ Sugar Manufacturing CRM
The CRM is for managing:
Leads (new potential buyers)
Customers (sugar buyers, bulk buyers, traders, ethanol/molasses buyers, export buyers)
Opportunities / Deals (potential sales)
Activities / Interactions (calls, meetings, plant visits, emails, WhatsApp, etc.)
Complaints / Service Issues (quality issues, delivery delays, etc.)
The CRM must support:
Sales team & marketing team
Management view (pipeline & dashboard)
ğŸ§± STEP 1 â€“ DATA MODEL (SUPABASE TABLES)
Design and use Supabase tables similar to the following (adjust to fit current project style):
crm_accounts (companies / customers)
id (PK)
account_name
account_type (customer, prospect, channel_partner)
industry (e.g., â€œFoodâ€, â€œBiscuitâ€, â€œBeverageâ€, â€œDistilleryâ€)
country
city
address
phone
email
gst_no (optional)
status (active, inactive)
created_by, owner_id (FK to user if available)
timestamps
crm_contacts
id
account_id (FK to crm_accounts)
name
designation
email
phone
is_primary (boolean)
timestamps
crm_leads
id
lead_name (person or company)
source (website, trade_fair, reference, cold_call, email, other)
email
phone
country, city
interested_in (sugar, molasses, ethanol, by_products, services)
status (new, contacted, qualified, unqualified, converted)
owner_id (salesperson)
notes
timestamps
crm_opportunities
id
account_id (FK)
title (e.g. â€œSupply 500 MT Sugar â€“ Q3â€)
stage (prospecting, proposal, negotiation, closed_won, closed_lost)
expected_value (numeric)
expected_close_date
probability (0â€“100)
owner_id
source_lead_id (optional FK to crm_leads)
notes
timestamps
crm_activities
id
account_id (FK)
contact_id (FK, optional)
opportunity_id (FK, optional)
type (call, meeting, visit, email, whatsapp, other)
subject
description
activity_date
next_follow_up_date (optional)
created_by
timestamps
crm_complaints
id
account_id
contact_id (optional)
category (quality, delivery, billing, other)
description
status (open, in_progress, resolved, closed)
logged_on
resolved_on (optional)
owner_id
timestamps
Please:
Provide SQL CREATE TABLE statements for Supabase.
Use consistent naming and FK relationships.
ğŸ§± STEP 2 â€“ BACKEND (NODE / EXPRESS) â€“ CRM APIs
Create RESTful APIs using the current project patterns. For example:
Leads
GET /api/crm/leads â†’ list (with filters: status, owner_id, search)
GET /api/crm/leads/:id â†’ get one
POST /api/crm/leads â†’ create lead
PUT /api/crm/leads/:id â†’ update lead
DELETE /api/crm/leads/:id â†’ soft delete or mark inactive
POST /api/crm/leads/:id/convert
Converts lead into:
New crm_account (if not existing)
Optional crm_contact
Updates lead status to converted
Accounts
GET /api/crm/accounts
GET /api/crm/accounts/:id
POST /api/crm/accounts
PUT /api/crm/accounts/:id
DELETE /api/crm/accounts/:id (soft delete)
Opportunities
GET /api/crm/opportunities (filters: stage, owner_id, account_id, date_range)
GET /api/crm/opportunities/:id
POST /api/crm/opportunities
PUT /api/crm/opportunities/:id
POST /api/crm/opportunities/:id/change-stage (update stage & probability)
Activities
GET /api/crm/activities (filters: account_id, owner_id, date_range)
POST /api/crm/activities
Complaints
GET /api/crm/complaints (filters: status, account_id)
POST /api/crm/complaints
PUT /api/crm/complaints/:id (update status, resolution details)
Requirements:
Use Supabase JS client for DB operations.
Wrap each route handler in try/catch with proper error responses.
Validate required fields (donâ€™t allow empty lead_name, etc.).
Return JSON with data and message fields for clarity.
ğŸ§± STEP 3 â€“ FRONTEND â€“ CRM DASHBOARD & SCREENS (ALL BUTTONS WORKING)
Create a main CRM page like src/pages/CrmDashboard.jsx with:
1. Top Summary Cards
Total Leads (open)
Open Opportunities
Pipeline Value (sum of expected_value for non-closed opportunities)
Open Complaints
Activities due today / this week
These must fetch live data from the CRM APIs.
2. Tabs or Buttons for Sections (All Functional)
At the top, add tabs or button group:
Leads
Accounts
Opportunities
Activities
Complaints
Clicking each tab should:
Update local state (activeTab)
Show the corresponding table/section below
NOT reload the whole page
ğŸ§± STEP 4 â€“ INDIVIDUAL MODULE UI & FUNCTIONALITY
A. Leads Section
Elements:
Search bar (by lead name, email, phone)
Filters: dropdown for status, source, owner
Table with columns:
Lead Name
Source
Status
Interested In
Owner
Created On
Actions (View, Edit, Convert, Delete)
Buttons (must be fully functional):
Add Lead â†’ open modal form â†’ calls POST /api/crm/leads.
Edit â†’ open pre-filled modal â†’ calls PUT /api/crm/leads/:id.
Convert to Customer â†’ open confirm dialog â†’ calls POST /api/crm/leads/:id/convert.
Delete â†’ confirm then calls DELETE /api/crm/leads/:id.
Search â†’ filter data (either client-side or via API query ?search=).
B. Accounts Section
Elements:
Search bar and filters (country, status, owner).
Table with:
Account Name
Type
Country / City
Industry
Owner
Actions (View, Edit, Add Opportunity, Add Contact)
Buttons:
Add Account â†’ modal â†’ POST /api/crm/accounts
Edit â†’ PUT /api/crm/accounts/:id
Add Contact â†’ modal linked to account â†’ POST /api/crm/contacts
Add Opportunity â†’ modal for new opportunity with account_id pre-selected
C. Opportunities Section
Elements:
Filters by stage, owner, date_range.
Search by title/account.
Table:
Title
Account
Stage
Expected Value
Expected Close
Owner
Actions (View, Edit, Change Stage)
Buttons:
Add Opportunity â†’ modal â†’ POST /api/crm/opportunities
Change Stage â†’ dropdown or button (Prospecting â†’ Proposal â†’ Negotiation â†’ Closed Won / Lost) calling POST /api/crm/opportunities/:id/change-stage
D. Activities Section
Elements:
List or table of interactions:
Date
Type (call/meeting/visit/email)
Account
Subject
Owner
Filters by date range, owner, account.
Buttons:
Log Activity â†’ modal form â†’ POST /api/crm/activities
Add Next Follow-up Date field in the form
E. Complaints Section
Elements:
Table:
Account
Category
Status
Logged On
Owner
Actions (View, Update Status)
Buttons:
Log Complaint â†’ modal â†’ POST /api/crm/complaints
Update Status â†’ PUT /api/crm/complaints/:id (change to in_progress/resolved/closed)
ğŸ§± STEP 5 â€“ STATE MANAGEMENT & UX
Use React hooks (useState, useEffect) for:
leads, accounts, opportunities, activities, complaints
activeTab, filters, searchTerm
loading, error
Implement:
Loading spinners/placeholders while fetching.
Error messages if API fails.
â€œNo data foundâ€ states.
All buttons must be wired with real handlers â€“ no dummy console.log only.
ğŸ¨ STYLE / UI
Keep consistent with the rest of the app (blue + yellow theme if already applied).
Use:
Buttons for actions
Modals for Add/Edit forms
Badges for status, stage, etc.
ğŸ“Œ HOW TO RESPOND
For each part, show:
Supabase SQL table definitions (CREATE TABLE statements).
Backend route file(s): e.g. server/routes/crmRoutes.js or separate files (crmLeadsRoutes.js, etc.).
Frontend React page: src/pages/CrmDashboard.jsx (or equivalent), including:
Tabs/Buttons
Summary cards
Tables
Add/Edit/Convert modals
Fully wired buttons and handlers
Always mention file paths and provide final code blocks for key files.
Main objective:
Build a fully functional, production-style CRM module for a Sugar Manufacturing ERP, where all buttons (add, edit, delete, convert, change stage, search, filter) actually work end-to-end using React + Node + Supabase.